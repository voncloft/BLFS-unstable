# description   : OpenJPEG is an open-source implementation of the JPEG-2000 standard
# depends       : cmake

name=openjpeg
version=2.5.3    
release=1
source="https://github.com/uclouvain/openjpeg/archive/v$version/openjpeg-$version.tar.gz"

options="!checksum"

build() {
    cd $name-$version
    
    mkdir -v build 
    cd       build 
    cmake -D CMAKE_BUILD_TYPE=Release  \
    -D CMAKE_INSTALL_PREFIX=/usr \
    -D BUILD_STATIC_LIBS=OFF ..  
    make
    git clone https://github.com/uclouvain/openjpeg-data.git --depth 1 
    OPJ_DATA_ROOT=$PWD/openjpeg-data cmake -D BUILD_TESTING=ON ..      
    make DESTDIR=$PKG                                                               
    make DESTDIR=$PKG test
    make DESTDIR=$PKG install 
    cp -rv ../doc/man -T /usr/share/man
}
