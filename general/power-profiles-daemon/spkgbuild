# description   : The Power-profiles-daemon package provides a program that allows modification of the system power/behavior state
# depends       : polkit pygobject upower

name=power-profiles-daemon
version=0.30    
release=1
source="https://gitlab.freedesktop.org/upower/power-profiles-daemon/-/archive/$version/power-profiles-daemon-$version.tar.gz"

options="!checksum"

build() {
    cd $name-$version
    
    mkdir build 
    cd build 
    meson setup                        \
    --prefix=/usr                \
    --buildtype=release          \
    -D gtk_doc=false             \
    -D tests=false               \
    -D systemdsystemunitdir=/tmp \
    .. 
    ninja
    powerprofilesctl
    powerprofilesctl set
    gov=
    for CPUFREQ in /sys/devices/system/cpu/cpufreq/policy*/scaling_governor; do
    echo -n ${gov} > ${CPUFREQ}"
    done
    DESTDIR=$PKG ninja install
    rm -fv /tmp/power-profiles-daemon.service
    install -vdm755 /var/lib/power-profiles-daemon
    make DESTDIR=$PKG install-power-profiles-daemon
}
