# description   : The Vulkan-Loader package contains a library which provides the Vulkan API and provides core support for graphics drivers for Vulkan
# depends       : cmake vulkanheaders xorglibraries wayland

name=vulkan-loader
version=1.4.321    
release=1
source="https://github.com/KhronosGroup/Vulkan-Loader/archive/v$version/Vulkan-Loader-$version.tar.gz"

options="!checksum"

build() {
    cd $name-$version
    
    mkdir build 
    cd    build 
    cmake -D CMAKE_INSTALL_PREFIX=/usr   \
    -D CMAKE_BUILD_TYPE=Release    \
    -D CMAKE_SKIP_INSTALL_RPATH=ON \
    -G Ninja .. 
    ninja
    sed "s/'git', 'clone'/, '--depth=1', '-b', self.commit/" \
    -i ../scripts/update_deps.py 
    cmake -D BUILD_TESTS=ON -D UPDATE_DEPS=ON .. 
    DESTDIR=$PKG ninja 
    DESTDIR=$PKG ninja test
    DESTDIR=$PKG ninja install
}
