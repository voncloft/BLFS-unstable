# description   : The WebKitGTK package is a port of the portable web rendering engine WebKit to the GTK+ 3 and GTK 4 platforms
# depends       : cairo cmake gstpluginsbase gstpluginsbad gtk gtk icu little cms libgudev libsecret libsoup libtasn1 libwebp mesa openjpeg ruby sqlite unifdef which bubblewrap enchant geoclue glib hicoloricontheme libavif libjxl libseccomp xdgdbusproxy

name=webkitgtk
version=2.48.5    
release=1
source="https://webkitgtk.org/releases/webkitgtk-$version.tar.xz"

options="!checksum"

build() {
    cd $name-$version
    
    mkdir -vp build 
    cd        build 
    cmake -D CMAKE_BUILD_TYPE=Release     \
    -D CMAKE_INSTALL_PREFIX=/usr    \
    -D CMAKE_SKIP_INSTALL_RPATH=ON  \
    -D PORT=GTK                     \
    -D LIB_INSTALL_DIR=/usr/lib     \
    -D USE_LIBBACKTRACE=OFF         \
    -D USE_LIBHYPHEN=OFF            \
    -D ENABLE_GAMEPAD=OFF           \
    -D ENABLE_MINIBROWSER=ON        \
    -D ENABLE_DOCUMENTATION=OFF     \
    -D ENABLE_WEBDRIVER=OFF         \
    -D USE_WOFF2=OFF                \
    -D USE_GTK4=OFF                 \
    -D ENABLE_JOURNALD_LOG=OFF      \
    -D ENABLE_BUBBLEWRAP_SANDBOX=ON \
    -D USE_SYSPROF_CAPTURE=NO       \
    -D ENABLE_SPEECH_SYNTHESIS=OFF  \
    -W no-dev -G Ninja ..           
    ninja
    rm -rf * .[^.]* 
    cmake -D CMAKE_BUILD_TYPE=Release      \
    -D CMAKE_INSTALL_PREFIX=/usr     \
    -D CMAKE_SKIP_INSTALL_RPATH=ON   \
    -D PORT=GTK                      \
    -D LIB_INSTALL_DIR=/usr/lib      \
    -D USE_LIBBACKTRACE=OFF          \
    -D USE_LIBHYPHEN=OFF             \
    -D ENABLE_GAMEPAD=OFF            \
    -D ENABLE_MINIBROWSER=ON         \
    -D ENABLE_DOCUMENTATION=OFF      \
    -D USE_WOFF2=OFF                 \
    -D USE_GTK4=ON                   \
    -D ENABLE_JOURNALD_LOG=OFF       \
    -D ENABLE_BUBBLEWRAP_SANDBOX=ON  \
    -D USE_SYSPROF_CAPTURE=NO        \
    -D ENABLE_SPEECH_SYNTHESIS=OFF   \
    -W no-dev -G Ninja ..            
    ninja
    DESTDIR=$PKG ninja install
    DESTDIR=$PKG ninja install
    install -vdm755 /usr/share/gtk-doc/html 
    cp -rv ../Documentation/* /usr/share/gtk-doc/html
}
