# description   : The Parted package is a disk partitioning and partition resizing tool
# depends       : lvm2

name=parted
version=3.6    
release=1
source="https://ftp.gnu.org/gnu/parted/parted-$version.tar.xz"

options="!checksum"

build() {
    cd $name-$version
    
    sed -i 's/do_version ()/do_version (PedDevice** dev, PedDisk** diskp)/' parted/parted.c
    ./configure --prefix=/usr --disable-static 
    make DESTDIR=$PKG 
    make DESTDIR=$PKG -C doc html                                       
    makeinfo --html      -o doc/html       doc/parted.texi 
    makeinfo --plaintext -o doc/parted.txt doc/parted.texi
    cp build-aux/texinfo.tex doc               
    texi2pdf -o doc/parted.pdf doc/parted.texi 
    texi2dvi -o doc/parted.dvi doc/parted.texi 
    dvips    -o doc/parted.ps  doc/parted.dvi
    make DESTDIR=$PKG check
    make DESTDIR=$PKG install 
    install -v -m755 -d /usr/share/doc/parted-$version/html 
    install -v -m644    doc/html/* \
    /usr/share/doc/parted-$version/html 
    install -v -m644    doc/{FAT,API,parted.{txt,html}} \
    /usr/share/doc/parted-$version
    install -v -m644 doc/FAT doc/API doc/parted.{pdf,ps,dvi} \
    /usr/share/doc/parted-$version
}
