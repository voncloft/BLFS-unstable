# description   : The CrackLib package contains a library used to enforce strong passwords by comparing user selected passwords to words in chosen word lists
# depends       : 

name=cracklib
version=2.10.3    
release=1
source="https://github.com/cracklib/cracklib/releases/download/v$version/cracklib-$version.tar.xz"

options="!checksum"

build() {
    cd $name-$version
    
    CPPFLAGS+=' -I /usr/include/python3.13' \
    ./configure --prefix=/usr               \
    --disable-static            \
    --with-default-dict=/usr/lib/cracklib/pw_dict 
    make
    make DESTDIR=$PKG test
    python3 -c 'import cracklib; cracklib.test()'
    make DESTDIR=$PKG install
    xzcat ../cracklib-words-$version.xz \
    > /usr/share/dict/cracklib-words       
    ln -v -sf cracklib-words /usr/share/dict/words                
    echo $(hostname) >>      /usr/share/dict/cracklib-extra-words 
    install -v -m755 -d      /usr/lib/cracklib                    
    create-cracklib-dict     /usr/share/dict/cracklib-words \
    /usr/share/dict/cracklib-extra-words
}
