# description   : No description available
# depends       : 

name=about firmware
version=
release=1
source=""

options="!checksum"

build() {
    cd $name-$version
    
    head -n7 /proc/cpuinfo
    mkdir -p initrd/kernel/x86/microcode
    cd initrd
    cp -v ../<MYCONTAINER> kernel/x86/microcode/AuthenticAMD.bin
    cp -v ../intel-ucode/<XX-YY-ZZ> kernel/x86/microcode/GenuineIntel.bin
    find . | cpio -o -H newc > /boot/microcode.img
    initrd /microcode.img
    initrd /boot/microcode.img
    dmesg | grep -e 'microcode' -e 'Linux version' -e 'Command line'
    mkdir -pv /usr/lib/firmware/radeon
    cp -v <YOUR_BLOBS> /usr/lib/firmware/radeon
    mkdir -pv /usr/lib/firmware/amdgpu
    cp -v <YOUR_BLOBS> /usr/lib/firmware/amdgpu
    wget https://anduin.linuxfromscratch.org/BLFS/nvidia-firmware/extract_firmware.py
    wget https://us.download.nvidia.com/XFree86/Linux-x86/340.32/NVIDIA-Linux-x86-340.32.run
    sh NVIDIA-Linux-x86-340.32.run --extract-only
    python3 extract_firmware.py
    mkdir -p /usr/lib/firmware/nouveau
    cp -d nv* vuc-* /usr/lib/firmware/nouveau/
    install -vdm755 /usr/lib/firmware/intel 
    cp -rv sof* /usr/lib/firmware/intel/
    echo CONFIG_EXTRA_FIRMWARE='"'$({ cd /usr/lib/firmware; echo
})'"' >> .config
make DESTDIR=$PKG oldconfig
}
