# description   : The NFS Utilities package contains the userspace server and client tools necessary to use the kernel's NFS abilities
# depends       : libevent libnl libtirpc libxml2 rpcsvcproto sqlite rpcbind

name=nfs-utils
version=2.8.3    
release=1
source="https://www.kernel.org/pub/linux/utils/nfs-utils/$version/nfs-utils-$version.tar.xz"

options="!checksum"

build() {
    cd $name-$version
    
    ./configure --prefix=/usr       \
    --sysconfdir=/etc   \
    --sbindir=/usr/sbin \
    --disable-nfsv4     \
    --disable-gss       \
    LIBS="-lsqlite3 -levent_core" 
    make
    make DESTDIR=$PKG install
    chmod u+w,go+r $PKG/usr/sbin/mount.nfs
    chown nobody:nogroup $PKG/var/lib/nfs
    mkdir -pv $PKG/etc
cat >> $PKG/etc/exports << EOF
    (rw,subtree_check,anonuid=99,anongid=99)
EOF
    mkdir -pv $PKG/etc/sysconfig
cat > $PKG/etc/sysconfig/nfs-server << "EOF"
    PORT="2049"
    PROCESSES="8"
    KILLDELAY="10"
EOF
}
